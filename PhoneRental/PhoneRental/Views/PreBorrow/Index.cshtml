@model IEnumerable<PhoneRental.Models.DeviceType>

@{
    ViewBag.Title = "Kölcsönözhető Készülékek";
}

<h2>Kölcsönözhető készülékek</h2>

<table id="myTable" class="tablesorter">
    <thead>
        <tr>
            <th></th>
            <th>
                @Html.DisplayNameFor(model => model.Brand.Name)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Type)
            </th>
            <th>
                Darab
            </th>
            <th>
                Elérhetőség
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
        <tr>
            <td>
                <a href="javascript:showImage('@Html.ValueFor(modelItem => item.ImageUrl)')">
                    <img src="/Images/Devices/thumb_@Html.ValueFor(modelItem => item.ImageUrl)" />
                </a>
            </td>
            <td id="bl_@item.Id">
                @Html.DisplayFor(modelItem => item.Brand.Name)
            </td>
            <td id="tl_@item.Id">
                @Html.DisplayFor(modelItem => item.Type)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Devices.Count)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Availability)
            </td>
            <td>
                @if (!item.HasPreBorrowedByUser) {
                @Html.ActionLink("Előfoglalás", "New", new { id=item.Id })
                } else
                {
                    <p>Erre a készülékre már van előfoglalásod!</p>
                    @Html.ActionLink("Előfoglalás törlése","Delete", new {id=item.Id}, new{@class="confirm", @id="l_"+item.Id.ToString()})
                }
            </td>
        </tr>
}
    </tbody>
</table>

@section Styles {
    @Styles.Render("~/Content/themes/base/jquery.tablesorter")
    @Styles.Render("~/Content/themes/base/jquery.ui.all")
}

@section Scripts {
    @Scripts.Render("~/bundles/jquerytablesorter")
    @Scripts.Render("~/bundles/jqueryui")
    @Scripts.Render("~/bundles/jqueryeasyconfirm") 
    <script type="text/javascript">
        $(document).ready(function () {
            $("#myTable").tablesorter({
                headers: { 0: { sorter: false }, 5: { sorter: false } },
                sortList: [[1, 0]]
            });
        });
        
        $(".confirm").easyconfirm({
            locale: {
                title: 'BME-AUT Mobilkölcsönző előfoglalás törlésének jóváhagyása',
                text: 'Biztos, hogy szeretnéd a kiválasztott előfoglalást törölni?<br/><div id="confirmtext"></div>',
                button: ['Nem', ' Jóváhagyás'],
                closeText: 'bezárás',
                onload: function (target) {
                    var brand = $("#b" + target.id).html();
                    var type = $("#t" + target.id).html();
                    var linkid = $("#confirmtext").html("<b>" + brand+" " + type + "</b>" );
                }
            }
        });
        
    </script>
}
